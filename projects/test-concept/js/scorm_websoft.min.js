ISCORM_ISAVAILABLE=isAvailable,ISCORM_INITIALIZE=LMSInitialize,ISCORM_GET=SCORM_GetValue,ISCORM_SET=SCORM_SetValue,ISCORM_COMMIT=SCORM_Commit,ISCORM_TERMINATE=LMSShutdown,ISCORM_VERSION=getVersion;var g_oScormApi=null,g_sScormApiVersion="",g_nScormMaxTries=500,g_bAicc=!1,g_sAiccSid="",g_sAiccUrl="",g_bUseScorm2004=!0,g_bUseScorm12=!0,g_bUseAicc=!1,g_bScorm=!1,g_sLmsCmiEntry="",g_sLmsCmiLocation="",g_sLmsCmiExit="",g_bLmsCmiExitSuspend=!1,g_sLmsCmiSuspendData="",g_dtSessionBegin=null,g_bLMSShotDown=!1,g_bLmsDebug=!0,g_aTerms={"true-false":"T",true_false:"T",T:"true-false",choice:"C",multiple_choice:"C",C:"choice","fill-in":"F",fill_in:"F",F:"fill-in","long-fill-in":"L",long_fill_in:"L",L:"long-fill-in",matching:"M",M:"matching",performance:"P",P:"performance",sequencing:"S",S:"sequencing",ordering:"O",O:"ordering",likert:"R",R:"likert",numeric:"N",N:"numeric",other:"H",H:"other",correct:"A",A:"correct",incorrect:"B",B:"incorrect",wrong:"W",W:"wrong",unanticipated:"U",U:"unanticipated",neutral:"E",E:"neutral"},g_aConstants=new Array;function isAvailable(){return!0}function getVersion(){return g_sScormApiVersion}function SCORM_ScanFor2004(e){try{e.document}catch(e){return null}for(var t=0;null==e.API_1484_11&&null!=e.parent&&e.parent!=e;){if(g_nScormMaxTries<++t)return null;e=e.parent}return e.API_1484_11}function SCORM_ScanFor12(e){try{e.document}catch(e){return null}for(var t=0;null==e.API&&null!=e.parent&&e.parent!=e;){if(g_nScormMaxTries<++t)return null;e=e.parent}return e.API}function SCORM_Obtain(e){var t=!1;g_bUseScorm2004&&(null!=e.parent&&e.parent!=e&&null==(g_oScormApi=SCORM_ScanFor2004(e.parent))&&null!=e.parent.opener&&(g_oScormApi=SCORM_ScanFor2004(e.parent.opener)),null==g_oScormApi&&null!=e.opener&&(g_oScormApi=SCORM_ScanFor2004(e.opener)),null!=g_oScormApi&&(g_sScormApiVersion="2004",t=!0)),0==t&&g_bUseScorm12&&(null!=e.parent&&e.parent!=e&&null==(g_oScormApi=SCORM_ScanFor12(e.parent))&&null!=e.parent.opener&&(g_oScormApi=SCORM_ScanFor12(e.parent.opener)),null==g_oScormApi&&null!=e.opener&&(g_oScormApi=SCORM_ScanFor12(e.opener)),null!=g_oScormApi&&(g_sScormApiVersion="1.2",t=!0)),t&&(g_bScorm=!0)}function SCORM_Initialize(){try{if(null!=g_oScormApi)switch(SCORM_InitSessionTime(),g_sScormApiVersion){case"2004":g_oScormApi.Initialize("");break;case"1.2":g_oScormApi.LMSInitialize("")}}catch(e){return alert(e),!1}return!0}function SCORM_Shutdown(){try{if(null!=g_oScormApi)switch(g_sScormApiVersion){case"2004":g_oScormApi.Terminate("");break;case"1.2":g_oScormApi.LMSFinish("")}}catch(e){return g_bLmsDebug&&alert(e),!1}return!0}function SCORM_GetValue(e){var t="";if(null!=g_oScormApi)switch(g_sScormApiVersion){case"2004":var r=g_oScormApi.GetValue(e);if("0"!=(n=g_oScormApi.GetLastError())){var i="ScormApi2004.GetValue:\n";i+='"'+e+'"\n',i+=g_oScormApi.GetErrorString(n)}else t=r;break;case"1.2":var n;r=g_oScormApi.LMSGetValue(e);if("0"!=(n=g_oScormApi.LMSGetLastError())){i="ScormApi12.LMSGetValue:\n";throw i+='"'+e+'"\n',i+=g_oScormApi.LMSGetErrorString(n)}t=r}return t}function SCORM_SetValue(e,t){if(null!=g_oScormApi)switch(g_sScormApiVersion){case"2004":var r=g_oScormApi.SetValue(e,t);if("0"!=(n=g_oScormApi.GetLastError())){var i="ScormApi2004.SetValue:\n";i+='"'+e+'"\n',i+='"'+t+'"\n',i+=g_oScormApi.GetErrorString(n)}break;case"1.2":var n;r=g_oScormApi.LMSSetValue(e,t);if("0"==(n=g_oScormApi.LMSGetLastError()))break;i="ScormApi12.SetValue:\n";throw i+='"'+e+'"\n',i+='"'+t+'"\n',i+=g_oScormApi.LMSGetErrorString(n)}return r}function SCORM_Commit(){if(null!=g_oScormApi)switch(g_sScormApiVersion){case"2004":var e=g_oScormApi.Commit("");if("0"==(r=g_oScormApi.GetLastError()))break;var t="ScormApi2004.Commit:\n";throw t+=g_oScormApi.GetErrorString(r);case"1.2":var r;e=g_oScormApi.LMSCommit("");if("0"==(r=g_oScormApi.LMSGetLastError()))break;t="ScormApi2004.LMSCommit:\n";throw t+=g_oScormApi.LMSGetErrorString(r)}return e}function SCORM_UnAbbreviateSuccessStatus(e){switch(e){case"p":e="passed";break;case"f":e="failed";break;case"u":e="unknown"}return e}function SCORM_UnAbbreviateCompletionStatus(e){switch(e){case"c":e="completed";break;case"i":e="incomplete";break;case"n":e="not attempted";break;case"u":e="unknown"}return e}function SCORM_GetObjectiveIndex(e){var t=-1,r=SCORM_GetValue("cmi.objectives._count");r=parseInt(r);for(var i=0;i<r;i++){if(SCORM_GetValue("cmi.objectives."+i+".id")==e){t=i;break}}return t}function SCORM_SaveObjectives(){if(null!=g_oScormApi)switch(g_sScormApiVersion){case"2004":for(var e=g_oSCO.selectNodes("objectives/o"),t=0;t<e.length;t++){var r=e[t];if("yes"!=r.getAttribute("module")){var i=r.getAttribute("id"),n=r.getAttribute("desc"),a=r.getAttribute("min"),s=r.getAttribute("max"),o=r.getAttribute("raw"),c=r.getAttribute("scaled"),l=r.getAttribute("ss"),u=r.getAttribute("cs");l=SCORM_UnAbbreviateSuccessStatus(l),u=SCORM_UnAbbreviateCompletionStatus(u);var S=SCORM_GetObjectiveIndex(i);if(-1==S){var g,_=SCORM_GetValue("cmi.objectives._count");SCORM_SetValue((g="cmi.objectives."+(S=parseInt(_)))+".id",i),SCORM_SetValue(g+".description",n)}SCORM_SetValue((g="cmi.objectives."+S)+".score.min",a),SCORM_SetValue(g+".score.max",s),SCORM_SetValue(g+".score.raw",o),SCORM_SetValue(g+".score.scaled",c),SCORM_SetValue(g+".success_status",l),SCORM_SetValue(g+".completion_status",u)}}if(null!=(m=g_oSCO.selectSingleNode("objectives/o[@module='yes']"))){a=m.getAttribute("min"),s=m.getAttribute("max"),o=m.getAttribute("raw"),c=m.getAttribute("scaled"),l=m.getAttribute("ss"),u=m.getAttribute("cs");l=SCORM_UnAbbreviateSuccessStatus(l),u=SCORM_UnAbbreviateCompletionStatus(u),g_bNormalize&&(o=parseInt(100*parseFloat(c)+.5)),SCORM_SetValue("cmi.score.min",a),SCORM_SetValue("cmi.score.max",s),SCORM_SetValue("cmi.score.raw",o),SCORM_SetValue("cmi.score.scaled",c),SCORM_SetValue("cmi.success_status",l),SCORM_SetValue("cmi.completion_status",u)}break;case"1.2":var m;if(null!=(m=g_oSCO.selectSingleNode("objectives/o[@module='yes']"))){a=m.getAttribute("min"),s=m.getAttribute("max"),o=m.getAttribute("raw"),c=m.getAttribute("scaled"),l=m.getAttribute("ss"),u=m.getAttribute("cs");switch(sStatus="u"!=l?l:u,sStatus){case"p":sStatus="passed";break;case"c":sStatus="completed";break;case"f":sStatus="failed";break;case"i":sStatus="incomplete";break;case"b":sStatus="browsed";break;case"n":sStatus="not attempted";break;case"u":sStatus="incomplete"}g_bNormalize&&(o=parseInt(100*parseFloat(c)+.5)),SCORM_SetValue("cmi.core.score.min",a.toString()),SCORM_SetValue("cmi.core.score.max",s.toString()),SCORM_SetValue("cmi.core.score.raw",o.toString()),"not attempted"!=sStatus&&SCORM_SetValue("cmi.core.lesson_status",sStatus)}}}function SCORM_InitSessionTime(){g_dtSessionBegin=new Date}function SCORM_SaveSessionTime(){if(null!=g_oScormApi)try{var e=new Date-g_dtSessionBegin,t=new Date(e),r=(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours()),i=t.getUTCMinutes(),n=t.getUTCSeconds(),a=parseInt(t.getUTCMilliseconds()/10);switch(g_sScormApiVersion){case"2004":n=parseInt(e/1e3),a=parseInt((e-1e3*n)/10);var s="PT";s+=n,a&&(s+=".",a<10&&(s+="0"),s+=a),SCORM_SetValue("cmi.session_time",s+="S");break;case"1.2":s="";r<10&&(s+="0"),s+=r+":",i<10&&(s+="0"),s+=i+":",n<10&&(s+="0"),s+=n,a&&(s+=".",a<10&&(s+="0"),s+=a),SCORM_SetValue("cmi.core.session_time",s)}}catch(e){return!1}return!0}function SCORM_GetInteractionIndex(e){var t=-1,r=SCORM_GetValue("cmi.interactions._count");r=parseInt(r);for(var i=0;i<r;i++){if(SCORM_GetValue("cmi.interactions."+i+".id")==e){t=i;break}}return t}function SCORM_GetInteractionObjectiveIndex(e,t){var r=-1,i=SCORM_GetValue("cmi.interactions."+e+".objectives._count");i=parseInt(i);for(var n=0;n<i;n++){if(SCORM_GetValue("cmi.interactions."+e+".objectives."+n+".id")==t){r=n;break}}return r}function SCORM_GetInteractionCorrectResponseIndex(e,t){var r=-1,i=SCORM_GetValue("cmi.interactions."+e+".correct_responses._count");i=parseInt(i);for(var n=0;n<i;n++){if(SCORM_GetValue("cmi.interactions."+e+".correct_responses."+n.toString()+".pattern")==t){r=n;break}}return r}function SCORM_SaveInteractions(){if(null!=g_oScormApi)switch(g_sScormApiVersion){case"2004":for(var e,t=SCORM_GetValue("cmi.interactions._children"),r=g_oSCO.selectNodes("interactions/i"),i="",n="",a="",s="",o="",c="",l="",u="",S=0;S<r.length;S++)if(null!=(i=(e=r[S]).getAttribute("id"))&&null!=(n=e.getAttribute("t"))){switch(n){case"multiple_choice":n="choice";break;case"true_false":n="true-false";break;case"fill_in":n="fill-in";break;case"long_fill_in":n="long-fill-in"}null==(a=e.getAttribute("w"))&&(a="0"),null==(s=e.getAttribute("l"))&&(s=""),null==(o=e.getAttribute("d"))&&(o=""),null==(u=e.getAttribute("r"))&&(u="incorrect"),c=e.getAttribute("b"),l=e.getAttribute("y");var g=SCORM_GetInteractionIndex(i);if(-1==g){var _=SCORM_GetValue("cmi.interactions._count");SCORM_SetValue((m="cmi.interactions."+(g=parseInt(_)))+".id",i)}var m="cmi.interactions."+g;if(null!=n&&SCORM_SetValue(m+".type",n),-1!=t.indexOf("objectives"))for(var C=e.selectNodes("oo/o"),d=0;d<C.length;d++){var p=C[d].getAttribute("id"),b=SCORM_GetInteractionObjectiveIndex(g,p);if(-1==b){var A=SCORM_GetValue("cmi.interactions."+g+".objectives._count");SCORM_SetValue("cmi.interactions."+g+".objectives."+(b=parseInt(A))+".id",p)}}if(-1!=t.indexOf("correct_responses")){var f=e.selectNodes("rr/r");for(d=0;d<f.length;d++){var O=f[d].getAttribute("p"),v=SCORM_GetInteractionCorrectResponseIndex(g,O);if(-1==v){var M=SCORM_GetValue("cmi.interactions."+g+".correct_responses._count");SCORM_SetValue("cmi.interactions."+g+".correct_responses."+(v=parseInt(M))+".pattern",O)}}}null!=a&&SCORM_SetValue(m+".weighting",a),null!=s&&SCORM_SetValue(m+".learner_response",s),null!=u&&SCORM_SetValue(m+".result",u),null!=c&&(-1!=t.indexOf("timestamp")?SCORM_SetValue(m+".timestamp",c):-1!=t.indexOf("datetime")&&SCORM_SetValue(m+".datetime",c)),null!=l&&SCORM_SetValue(m+".latency",l),null!=o&&SCORM_SetValue(m+".description",o)}return!0}return!1}function SCORM_Load(){var e=!1;try{switch(g_sScormApiVersion){case"2004":if("resume"==(g_sLmsCmiEntry=SCORM_GetValue("cmi.entry"))||""==g_sLmsCmiEntry){if(g_sLmsCmiLocation=SCORM_GetValue("cmi.location"),RestoreSuspendData(r=SCORM_GetValue("cmi.suspend_data")))g_sLmsCmiSuspendData=g_oSCO.xml;else if(null!=r&&""!=r){g_sLmsCmiSuspendData=ReplaceStr(r,'\\"','"');var t=CreateDOMDocument();try{t.loadXML(g_sLmsCmiSuspendData)}catch(e){}""!=t.xml&&(g_oDocSCO.loadXML(g_sLmsCmiSuspendData),g_oSCO=g_oDocSCO.selectSingleNode("//SCO"))}""!=g_sLmsCmiLocation&&""!=g_sLmsCmiSuspendData&&(e=!0)}break;case"1.2":if("resume"==(g_sLmsCmiEntry=SCORM_GetValue("cmi.core.entry"))||""==g_sLmsCmiEntry){var r;if(g_sLmsCmiLocation=SCORM_GetValue("cmi.core.lesson_location"),RestoreSuspendData(r=SCORM_GetValue("cmi.suspend_data")))g_sLmsCmiSuspendData=g_oSCO.xml;else if(null!=r&&""!=r){g_sLmsCmiSuspendData=ReplaceStr(r,'\\"','"');t=CreateDOMDocument();try{t.loadXML(g_sLmsCmiSuspendData)}catch(e){}""!=t.xml&&(g_oDocSCO.loadXML(g_sLmsCmiSuspendData),g_oSCO=g_oDocSCO.selectSingleNode("//SCO"))}""!=g_sLmsCmiLocation&&""!=g_sLmsCmiSuspendData&&(e=!0)}}}catch(e){g_bLmsDebug&&alert(e)}return e}function SCORM_Save(){try{switch(g_sScormApiVersion){case"2004":SCORM_SaveSessionTime(),SCORM_SetValue("cmi.location",g_sLmsCmiLocation),SCORM_SetValue("cmi.exit",g_bLmsCmiExitSuspend?"suspend":""),SCORM_SaveObjectives(),SCORM_SaveInteractions(),SCORM_SetValue("cmi.suspend_data",PrepareSuspendData(!0,!0)),SCORM_Commit();break;case"1.2":SCORM_SaveSessionTime(),SCORM_SetValue("cmi.core.lesson_location",g_sLmsCmiLocation),SCORM_SetValue("cmi.core.exit",g_bLmsCmiExitSuspend?"suspend":""),SCORM_SaveObjectives(),SCORM_SaveInteractions(),SCORM_SetValue("cmi.suspend_data",PrepareSuspendData(!0,!0)),SCORM_Commit()}}catch(e){g_bLmsDebug&&alert(e)}}function AICC_Obtain(e){if(g_bUseAicc){var t=window.location.search;if(0<t.length){for(var r=t.split("&"),i=0;i<r.length;i++){0==r[i].indexOf("?")&&(r[i]=r[i].substring(1,r[i].length));var n=r[i].split("=");if(2==n.length){var a=n[0],s=n[1];switch(a=a.toLowerCase()){case"aicc_sid":g_sAiccSid=s;break;case"aicc_url":g_sAiccUrl=unescape(s)}}}""!=g_sAiccSid&&""!=g_sAiccUrl&&(g_bAicc=!0)}}}function AICC_Initialize(){}function AICC_Shutdown(){}function AICC_Load(){try{var e="command=GetParam&version=2.0&session_id="+escape(g_sAiccSid)+"&AICC_Data="+escape(""),t=CreateXMLHTTP();if(t.open("POST",g_sAiccUrl,!1),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(e),200!=t.status){var r="AICC_Load:\n";throw r+="XmlHttp.status "+t.status}AICC_HandleResponse(t.responseText),AICC_InitSessionTime()}catch(r){return g_bLmsDebug&&alert(r),!1}return!0}function AICC_Save(){try{var e=AICC_PrepareData(),t="command=PutParam&version=2.0&session_id="+escape(g_sAiccSid)+"&AICC_Data="+escape(e),r=CreateXMLHTTP();if(r.open("POST",g_sAiccUrl,!1),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(t),200!=r.status){var i="AICC_Save:\n";throw i+="XmlHttp.status "+r.status}}catch(i){return g_bLmsDebug&&alert(i),!1}return!0}function AICC_PrepareData(){var e="0",t="i",r=g_oSCO.selectSingleNode("objectives/o[@module='yes']");if(null!=r){var i=r.getAttribute("raw"),n=r.getAttribute("scaled");g_bNormalize&&(i=parseInt(100*parseFloat(n)+.5)),e=i;var a=r.getAttribute("ss"),s=r.getAttribute("cs");t="u"!=a?a:s}var o=String.fromCharCode(13,10),c="";c+="[CORE]"+o,c+="Lesson_Location="+g_sLmsCmiLocation+o,c+="Lesson_Status="+t+o,c+="Score="+e+o,c+="Time="+AICC_ReturnSessionTime()+o,AICC_InitSessionTime(),c+="[CORE_LESSON]"+o,c+="Suspend_Data="+PrepareSuspendData(!0,!0)+o,c+="[OBJECTIVES_STATUS]"+o;for(var l=1,u=g_oSCO.selectNodes("objectives/o"),S=0;S<u.length;S++){var g=u[S];if("yes"!=g.getAttribute("module")){var _=g.getAttribute("id");i=g.getAttribute("raw"),a=g.getAttribute("ss"),s=g.getAttribute("cs");c+="J_ID."+l+"="+_+o,c+="J_Score."+l+"="+i+o,c+="J_Status."+l+"="+(t="u"!=a?a:s)+o,l+=1}}return c}function AICC_HandleResponse(e){String.fromCharCode(13,10);var t=String.fromCharCode(10),r=unescape(e);r=r.replace(/^;.*$/gm,"");for(var i=/^\[(\w+)\]$/m,n=null;0!=r.length;){var a=r.search(i),s=(r=r.substr(a)).replace(i,"$1 "),o=s.substr(0,s.search(" ")),c=(s=s.substr(o.length+1)).search(i);-1==c&&(c=s.length),r=s.substr(c),s=(s=(s=s.substr(0,c)).replace(/[\n\r]+/gm,t)).replace(/^[\n]+/gm,""),(l=new Object).sName=o.toLowerCase(),l.arVars=s.split(t),l.pNext=n,n=l}for(var l=n;null!=l;l=l.pNext)for(var u=0;u<l.arVars.length;u++){var S=l.arVars[u];if(0<S.length){var g=S.search("="),_=S.substring(0,g),m=S.substring(g+1);if(_=_.toLowerCase(),"core"==l.sName)switch(_){case"lesson_status":var C=(m=m.toLowerCase()).split(","),d=(C[0],"r");1<C.length&&(d=C[1]),"r"!=d&&"resume"!=d||(g_sLmsCmiEntry="resume");break;case"lesson_location":g_sLmsCmiLocation=m}else if("core_lesson"==l.sName)switch(_){case"suspend_data":var p=m;if(RestoreSuspendData(p))g_sLmsCmiSuspendData=g_oSCO.xml;else if(null!=p&&""!=p){g_sLmsCmiSuspendData=ReplaceStr(p,'\\"','"');var b=CreateDOMDocument();try{b.loadXML(g_sLmsCmiSuspendData)}catch(e){}""!=b.xml&&(g_oDocSCO.loadXML(g_sLmsCmiSuspendData),g_oSCO=g_oDocSCO.selectSingleNode("//SCO"))}}}}}function LMSInitialize(){return SCORM_Obtain(window),g_bScorm?SCORM_Initialize():(AICC_Obtain(window),g_bAicc&&AICC_Initialize(),!1)}function LMSShutdown(){if(0==g_bLMSShotDown)return g_bScorm?SCORM_Shutdown():g_bAicc&&AICC_Shutdown(),g_bLMSShotDown=!0}function LMSLoadState(){var e=!1;if(0==g_bLMSShotDown)try{g_bScorm?e=SCORM_Load():g_bAicc&&(e=AICC_Load())}catch(e){}return e}function LMSSaveState(){if(0==g_bLMSShotDown)try{g_bScorm?SCORM_Save():g_bAicc&&AICC_Save()}catch(e){}}function RemoveInteractionNode(e){var t=g_oSCO.selectSingleNode("interactions"),r=GetInteraction(e);if(null==r)return!1;t.removeChild(r);return!null}function RemoveInteractionParam(e,t){var r=GetInteraction(e);if(null==r)return!1;var i="y";return"latency"!=t&&(i=t.charAt(0)),null!=r.getAttribute(i)&&r.removeAttribute(i),!0}function ReturnInteraction(e,t){if(t&&RemoveInteractionNode(e),null==(i=GetInteraction(e))){if(null==(r=g_oSCO.selectSingleNode("interactions"))){var r=g_oDocSCO.createElement("interactions");g_oSCO.appendChild(r)}var i=g_oDocSCO.createElement("i");r.appendChild(i),i.setAttribute("id",e);var n=new Date,a=ConvertDateToISO8601(n);i.setAttribute("b",a)}return i}function SetInteractionParam(e,t,r){var i=ReturnInteraction(e),n="y";return"latency"!=t&&(n=t.charAt(0)),i.setAttribute(n,r),!0}function SetInteractionArrayItem(e,t,r){var i=ReturnInteraction(e),n="objectives"==t?"oo":"rr",a="objectives"==t?"o":"r",s="objectives"==t?"id":"p",o=i.selectSingleNode(n);null==o&&(o=g_oDocSCO.createElement(n),i.appendChild(o));var c=o.selectNodes(a);if(0<c.length)for(var l=0;l<c.length;l++)if(c[l].getAttribute(s)==r)return!1;var u=g_oDocSCO.createElement(a);return o.appendChild(u),u.setAttribute(s,r),!0}function GetInteractionParam(e,t){var r=GetInteraction(e);if(null==r)return null;var i="timestamp"==t?"b":"y";return"latency"!=t&&"timestamp"!=t&&(i=t.charAt(0)),r.getAttribute(i)}function GetInteractionArray(e,t){var r=GetInteraction(e);if(null==r)return null;var i="objectives"==t?"oo":"rr",n=r.selectSingleNode(i);if(null==n)return null;var a="objectives"==t?"o":"r",s=n.selectNodes(a);if(0==s.length)return null;for(var o="objectives"==t?"id":"p",c="",l=[],u=0;u<s.length;u++)null!=(c=s[u].getAttribute(o))&&l.push(c);return l}function AICC_InitSessionTime(){g_dtSessionBegin=new Date}function AICC_ReturnSessionTime(){if(g_bAicc)try{var e=new Date,t=new Date(e-g_dtSessionBegin),r=(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours()),i=t.getUTCMinutes(),n=t.getUTCSeconds(),a="";return r<10&&(a+="0"),a+=r+":",i<10&&(a+="0"),a+=i+":",n<10&&(a+="0"),a+=n}catch(e){return"00:00:00"}return"00:00:00"}function PrepareSuspendData(e,t){var r="",i=new Array;g_aConstants=new Array;var n=CreateDOMDocument(),a=n.createElement("S");g_isMSIE?n.appendChild(a):g_isFirefox&&n.documentElement.appendChild(a);var s=g_oSCO.selectSingleNode("visits");for(var o in null!=s&&s.hasChildNodes()&&(null==(r=s.text)&&(r=""),AppendNode(n,a,"Z",r)),g_arVars){var c=AppendNode(n,a,"V");for(var l in g_arVars)"indexOf"!=l&&AppendNode(n,c,"I",g_arVars[l]).setAttribute("i",l);break}var u=g_oSCO.selectSingleNode("objects");if(null!=u&&u.hasChildNodes()){i=u.childNodes;var S,g=AppendNode(n,a,"O");for(o=0;o<i.length;o++)1==i[o].nodeType&&(S=i[o].cloneNode(!0),g.appendChild(S))}if(e){var _=g_oSCO.selectSingleNode("objectives");if(null!=_&&_.hasChildNodes()){var m,C=_.selectNodes("o"),d=AppendNode(n,a,"J");for(o=0;o<C.length;o++)if(m=AppendNode(n,d,"I"),r=MaskValue(C[o].getAttribute("id")),m.setAttribute("i",r),r=C[o].getAttribute("raw"),m.setAttribute("r",r),r=C[o].getAttribute("scaled"),m.setAttribute("l",r),r=C[o].getAttribute("cs"),m.setAttribute("c",r),r=C[o].getAttribute("ss"),m.setAttribute("s",r),C[o].hasChildNodes()){var p=C[o].selectNodes("s"),b=new Array;for(l=0;l<p.length;l++)r=MaskValue(p[l].getAttribute("id")),r+="#"+p[l].getAttribute("raw"),b.push(r);0<b.length&&m.setAttribute("u",b.join("~"))}}}if(t){var A=g_oSCO.selectSingleNode("interactions");if(null!=A&&A.hasChildNodes()){var f,O=A.selectNodes("i"),v=AppendNode(n,a,"R");for(o=0;o<O.length;o++)if((f=AppendNode(n,v,"I")).setAttribute("i",MaskValue(O[o].getAttribute("id"))),null!=(r=O[o].getAttribute("t"))&&f.setAttribute("t",g_aTerms[r]),null!=(r=O[o].getAttribute("r"))&&f.setAttribute("r",g_aTerms[r]),null!=(r=O[o].getAttribute("b"))&&f.setAttribute("b",MaskValue(r,"time")),null!=(r=O[o].getAttribute("y"))&&f.setAttribute("y",MaskValue(r,"period")),null!=(r=O[o].getAttribute("d"))&&f.setAttribute("d",r),null!=(r=O[o].getAttribute("l"))&&f.setAttribute("l",r),null!=(r=O[o].getAttribute("w"))&&f.setAttribute("w",r),O[o].hasChildNodes()){if(0<(i=O[o].selectNodes("oo/o")).length){var M=new Array;for(l=0;l<i.length;l++)M.push(i[l].getAttribute("id"));f.setAttribute("o",M.join("~"))}if(0<(i=O[o].selectNodes("rr/r")).length){for(M=new Array,l=0;l<i.length;l++)M.push(i[l].getAttribute("p"));f.setAttribute("p",M.join("[~]"))}}}}return 0<g_aConstants.length&&AppendNode(n,a,"C",g_aConstants.join("~")),n.selectSingleNode("//S").xml}function RestoreSuspendData(e){var t=Trim(e),r="",i="",n=t.indexOf("<S>"),a=t.indexOf("</S>");if(-1==n||-1==a)return!1;t=t.substring(n,a+4);var s=CreateDOMDocument();try{s.loadXML(t)}catch(e){return!1}var o=s.selectSingleNode("//S");if(null==o)return!1;var c=o.selectSingleNode("C");null!=c&&(g_aConstants=c.text.split("~"));var l=o.selectSingleNode("Z");if(null!=l){var u=g_oSCO.selectSingleNode("visits");SetTextNodeValue(g_oDocSCO,u,l.text)}var S=o.selectSingleNode("V");if(null!=S)for(var g=S.selectNodes("I"),_=0;_<g.length;_++)r=g[_].getAttribute("i"),g_arVars[decodeURI(r)]=g[_].text;var m=o.selectSingleNode("O");if(null!=m&&m.hasChildNodes()){var C,d=g_oSCO.selectSingleNode("objects"),p=m.childNodes;for(_=0;_<p.length;_++)1==p[_].nodeType&&(C=p[_].cloneNode(!0),d.appendChild(C))}var b=o.selectSingleNode("J");if(null!=b){var A,f=g_oSCO.selectSingleNode("objectives"),O=b.selectNodes("I");for(_=0;_<O.length;_++)if(r=UnmaskValue(O[_].getAttribute("i")),null!=(A=f.selectSingleNode("o[@id='"+r+"']"))&&(null!=(i=O[_].getAttribute("r"))&&A.setAttribute("raw",i),null!=(i=O[_].getAttribute("l"))&&A.setAttribute("scaled",i),null!=(i=O[_].getAttribute("c"))&&A.setAttribute("cs",i),null!=(i=O[_].getAttribute("s"))&&A.setAttribute("ss",i),null!=(i=O[_].getAttribute("u"))))for(var v,M=i.split("~"),R=0,h=0;h<M.length;h++)-1!=(R=M[h].lastIndexOf("#"))&&(r=M[h].substring(0,R),i=M[h].substr(R+1),r=UnmaskValue(r),null==(v=A.selectSingleNode("s[@id='"+r+"']"))&&(v=AppendNode(g_oDocSCO,A,"s")).setAttribute("id",r),v.setAttribute("raw",i))}var I=o.selectSingleNode("R");if(null!=I){var L,V=g_oSCO.selectSingleNode("interactions"),w=I.selectNodes("I");for(_=0;_<w.length;_++){if(r=UnmaskValue(w[_].getAttribute("i")),null==(L=V.selectSingleNode("i[@id='"+r+"']"))&&(L=AppendNode(g_oDocSCO,V,"i")).setAttribute("id",r),null!=(i=w[_].getAttribute("t"))&&L.setAttribute("t",g_aTerms[i]),null!=(i=w[_].getAttribute("r"))&&L.setAttribute("r",g_aTerms[i]),null!=(i=w[_].getAttribute("b"))&&L.setAttribute("b",UnmaskValue(i,"time")),null!=(i=w[_].getAttribute("y"))&&L.setAttribute("y",UnmaskValue(i,"period")),null!=(i=w[_].getAttribute("d"))&&L.setAttribute("d",i),null!=(i=w[_].getAttribute("l"))&&L.setAttribute("l",i),null!=(i=w[_].getAttribute("w"))&&L.setAttribute("w",i),null!=(i=w[_].getAttribute("o"))){var N=i.split("~");for(h=0;h<N.length;h++)SetInteractionArrayItem(r,"objectives",N[h])}if(null!=(i=w[_].getAttribute("p"))){var D=i.split("[~]");for(h=0;h<D.length;h++)SetInteractionArrayItem(r,"correct_responses",D[h])}}}return!0}window.onunload=function(){LMSShutdown()},window.onbeforeunload=function(){LMSShutdown()};